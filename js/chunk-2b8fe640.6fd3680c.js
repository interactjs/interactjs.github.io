(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b8fe640"],{"603c":function(e,t,r){"use strict";r.r(t);var n=r("82b7"),a=r.n(n);for(var i in n)"default"!==i&&function(e){r.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},"6a98":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"field"},[r("div",{staticClass:"control"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.subject,expression:"subject"}],staticClass:"input",attrs:{required:""},domProps:{value:e.subject},on:{input:[function(t){t.target.composing||(e.subject=t.target.value)},function(t){e.preview=""}]}})])]),r("div",{staticClass:"field"},[r("div",{staticClass:"control"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.markdown,expression:"markdown"}],staticClass:"textarea",attrs:{required:""},domProps:{value:e.markdown},on:{input:[function(t){t.target.composing||(e.markdown=t.target.value)},function(t){e.preview=""}]}})])]),r("div",{staticClass:"field"},[r("div",{staticClass:"control"},[r("button",{staticClass:"button is-primary",class:{"is-loading":e.loading},attrs:{disabled:e.loading,type:"button"},on:{click:e.previewSave}},[e._v(" "+e._s(e.preview?"Save":"Preview")+" ")])])]),e.error?[r("div",{staticClass:"notification is-warning has-text-centered"},[e._v(" Something went wrong. "),r("br"),e._v(" ("+e._s(e.error)+") ")])]:e.preview?r("div",[r("p",[r("code",[e._v("Subject: "+e._s(e.subject))])]),r("div",{staticClass:"content",domProps:{innerHTML:e._s(e.preview)}}),r("br"),e.campaignId&&e.preview?r("button",{staticClass:"button is-success",class:{"is-loading":e.loading},attrs:{disabled:e.loading,type:"button"},on:{click:function(t){return e.send({test:!0})}}},[e._v(" Send to test subscribers ")]):e._e(),r("br"),r("br"),r("br"),r("br"),e.campaignId&&e.preview?r("button",{staticClass:"button is-danger is-outlined",class:{"is-loading":e.loading},attrs:{disabled:e.loading,type:"button"},on:{click:function(t){return e.send({test:!1})}}},[e._v(" Send ")]):e._e()]):e._e()],2)},a=[]},"715e":function(e,t,r){"use strict";var n=r("8ef1"),a=r("0359"),i=r("f8fb"),s=r("720b"),o=r("c138"),c=r("45df"),u=r("81e2"),d=r("535a"),l=Math.max,v=Math.min,p=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,g=/\$([$&'`]|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};n("replace",2,(function(e,t,r,n){var w=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=n.REPLACE_KEEPS_$0,h=w?"$":"$0";return[function(r,n){var a=c(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,a,n):t.call(String(a),r,n)},function(e,n){if(!w&&b||"string"===typeof n&&-1===n.indexOf(h)){var i=r(t,e,this,n);if(i.done)return i.value}var c=a(e),p=String(this),f="function"===typeof n;f||(n=String(n));var g=c.global;if(g){var x=c.unicode;c.lastIndex=0}var _=[];while(1){var S=d(c,p);if(null===S)break;if(_.push(S),!g)break;var C=String(S[0]);""===C&&(c.lastIndex=u(p,s(c.lastIndex),x))}for(var R="",E=0,y=0;y<_.length;y++){S=_[y];for(var j=String(S[0]),I=l(v(o(S.index),p.length),0),$=[],q=1;q<S.length;q++)$.push(m(S[q]));var P=S.groups;if(f){var A=[j].concat($,I,p);void 0!==P&&A.push(P);var M=String(n.apply(void 0,A))}else M=k(j,p,I,$,P,n);I>=E&&(R+=p.slice(E,I)+M,E=I+j.length)}return R+p.slice(E)}];function k(e,r,n,a,s,o){var c=n+e.length,u=a.length,d=g;return void 0!==s&&(s=i(s),d=f),t.call(o,d,(function(t,i){var o;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(c);case"<":o=s[i.slice(1,-1)];break;default:var d=+i;if(0===d)return t;if(d>u){var l=p(d/10);return 0===l?t:l<=u?void 0===a[l-1]?i.charAt(1):a[l-1]+i.charAt(1):t}o=a[d-1]}return void 0===o?"":o}))}}))},"82b7":function(e,t,r){"use strict";var n=r("c44c");r("d0a5"),r("715e"),Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0,r("daeb");var a=n(r("d4e2")),i=r("7dda"),s="## Enter markdown message",o={props:{campaignId:{type:String,default:""},token:{type:String,required:!0}},data:function(){return{loading:!1,error:!1,markdown:s,preview:"",campaign:null,subject:""}},watch:{campaignId:function(e){var t=this;return(0,a["default"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.getCampaign();case 1:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.token||this.__prerendering?this.getCampaign():this.$router.replace("/")},methods:{previewSave:function(){var e=this;return(0,a["default"])(regeneratorRuntime.mark((function t(){var r,n,a,i,s,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=!e.preview,e.error=!1,e.loading=!0,t.prev=3,!r){t.next=16;break}return e.preview="",t.next=8,e.campaignRequest("preview");case 8:if(n=t.sent,a=n.html,i=n.error,!i){t.next=13;break}throw new Error(i);case 13:e.preview=a,t.next=24;break;case 16:return t.next=18,e.campaignRequest("save");case 18:if(s=t.sent,o=s.campaign,c=s.error,!c){t.next=23;break}throw new Error(c);case 23:o._id!==e.campaignId&&e.$router.replace({path:"/newsletter/compose/"+o._id,query:e.$route.query});case 24:t.next=29;break;case 26:t.prev=26,t.t0=t["catch"](3),e.error=t.t0.message;case 29:e.loading=!1;case 30:case"end":return t.stop()}}),t,null,[[3,26]])})))()},getCampaign:function(){var e=this;return(0,a["default"])(regeneratorRuntime.mark((function t(){var r,n,a,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.markdown=s,e.subject="",e.preview="",e.error=null,!e.campaignId){t.next=27;break}return e.loading=!0,t.prev=6,t.next=9,e.campaignRequest("get");case 9:if(r=t.sent,n=r.campaign,a=r.error,!a){t.next=14;break}throw new Error(a);case 14:return e.markdown=n.markdown,e.subject=n.subject,t.next=18,e.campaignRequest("preview");case 18:i=t.sent,o=i.html,e.preview=o,t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](6),e.error=t.t0.message;case 26:e.loading=!1;case 27:case"end":return t.stop()}}),t,null,[[6,23]])})))()},send:function(e){var t=this;return(0,a["default"])(regeneratorRuntime.mark((function r(){var n,a,i,s,o,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e.test,a=void 0===n||n,a||"yes"===window.prompt('Are you sure you want to send this newsletter out for real? Enter "yes"')){r.next=3;break}return r.abrupt("return");case 3:return t.loading=!0,r.next=6,t.campaignRequest("send",{test:a});case 6:i=r.sent,s=i.sent,o=i.failed,c=i.error,window.alert("Sent to "+s+" out of "+(s+o)+" subscribers. "+(c||"")),t.loading=!1,t.error=c;case 13:case"end":return r.stop()}}),r)})))()},campaignRequest:function(e,t){var r=this.token,n=this.markdown,a=this.campaignId,s=this.subject;return(0,i.apiRequest)("newsletter/campaign/"+e,Object.assign({markdown:n,campaignId:a,subject:s},t),{headers:{authorization:"Bearer "+r}})}}};t["default"]=o},ba3c:function(e,t,r){"use strict";r.r(t);var n=r("6a98"),a=r("603c");for(var i in a)"default"!==i&&function(e){r.d(t,e,(function(){return a[e]}))}(i);var s=r("6f6f"),o=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,null,null);t["default"]=o.exports}}]);
//# sourceMappingURL=chunk-2b8fe640.6fd3680c.js.map